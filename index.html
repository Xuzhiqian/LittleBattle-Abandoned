<!DOCTYPE html>
<html>
<head>

    <title>Little Battle</title>
    <link href="index.css" media="screen" rel="stylesheet" type="text/css">

    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script src="keyboard.js"></script>
    <script src="quisus.js"></script>
</head>

<body>
<div id="login">
    Your nickname:<br/>
    <input type="text" id="clientNameText">
    <button id="loginBtn">Connect</button>
</div>
<div id="game" class="hidden-div">
    <canvas id="map"></canvas>
</div>
<script>core = {};</script>
<script src="core.js"></script>
<script src="client.js"></script>
<script>
	$("#loginBtn").click(function () {

		var nickname = String(($("#clientNameText").val()) || 'unknown');
		if (nickname.indexOf('#')!=-1) {alert("No '#' in your nickname!"); return;}

		core = new Q.client_core();
		var socket = io.connect();
		socket.emit('id_checkdup',nickname);

		core.bind('verified',(function(newname){
			$("#login").addClass("hidden-div");
			$("#game").removeClass("hidden-div");
			var enviroment = {
				socket: socket,
				keyboard: new THREEx.KeyboardState(),
				map: document.getElementById('map'),
				ctx: map.getContext('2d')
			}
			enviroment.socket.client_id = newname;
			core.client_initialize(enviroment);
		}).bind(this));

		socket.on('verified',function(id){core.trigger('verified',id);});
	});
</script>


</body>
</html>